import{h as f,c as m}from"./authorPosts-ya0caLeO.js";import{s as n,a as h,h as g}from"./feed-FQitdmyJ.js";async function w(o,i,e){const r={name:o,email:i,password:e},a=f();try{const s=await fetch(m,{method:"POST",headers:a,body:JSON.stringify(r)});if(!s.ok){const t=await s.json();throw new Error(t.errors?.[0]?.message||"Registration failed")}return await s.json()}catch(s){throw console.error("Error registering user:",s),s}}async function v(o){o.preventDefault();const i=o.target,e=i.username,r=i.email,a=i.password,s=e.value.trim(),t=r.value.trim(),d=a.value;[e,r,a].forEach(l=>l.classList.remove("is-invalid"));let c=!1;if(s||(e.classList.add("is-invalid"),c=!0),t||(r.classList.add("is-invalid"),c=!0),d||(a.classList.add("is-invalid"),c=!0),c){n("Please fill in all fields","error");return}const u=s.match(/[^\w\s]/g);if(u&&u.length>0&&!s.includes("_")){e.classList.add("is-invalid"),n("Username can only contain letters, numbers, and underscores","error");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)||!t.endsWith("@stud.noroff.no")){r.classList.add("is-invalid"),n("Email must be a valid @stud.noroff.no address","error");return}if(d.length<8){a.classList.add("is-invalid"),n("Password must be at least 8 characters","error");return}try{h(),await w(s,t,d)&&(sessionStorage.setItem("notification",JSON.stringify({type:"success",message:"Registered successfully!"})),window.location.href="/fed2-js2-ca-Mayamariaruth/auth/login/")}catch(l){n(l.message,"error")}finally{g()}}const y=document.forms.registerForm;y.addEventListener("submit",v);
